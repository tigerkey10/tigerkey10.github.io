---

---

# 회귀분석(Regression Analysis)

통계적 모형 중 회귀함수를 찾는 분석이다. 

## 통계적(확률론적) 모형

입력과 출력 사이 관계가 일정하게 대응되지 않는 모형. 항상 오차를 수반한다. 

$Y = f(x_{1}, x_{2}, x_{3}, ... x_{n}) + \epsilon$

$\epsilon$ 이 오차항이며, $N(0, \sigma^{2})$ 을 따르는 확률변숫값이다. 따라서 출력 $Y$ 도 확률변숫값이다. 

## 수학적(결정론적) 모형

입력과 출력 사이 일정한 대응관계 성립하는 모형. 수학적 함수다. 오차를 수반하지 않는다. 

$Y = f(x_{1}, x_{2}, x_{3}, ... x_{n})$

## 회귀모형은 통계적 모형이다. 

---

# 회귀모형(Regression Model)

회귀모형은 회귀함수 $f(x_{i})$ 와 오차항 $\epsilon$ 으로 구성된다. 

## $Y = f(x_{1}, x_{2}, x_{3}, ... x_{n}) + \epsilon$

회귀분석은 위 모형에서 회귀함수 $f(x_{1}, x_{2}, x_{3}, ... x_{n})$ 를 찾는 분석이다. 

- $Y:$ 반응변수, 종속변수 
- $x_{1}, x_{2}, ... x_{n}:$ 설명변수, 독립변수 
- $\epsilon:$ 오차항
- $f(x_{1}, x_{2}, x_{3}, ... x_{n}):$ 회귀함수

# 회귀모형 종류

회귀모형 = 회귀함수 + 오차 

회귀함수 종류에 따라 회귀모형을 구분한다. 

## 모수회귀모형 

정의: 회귀함수 형태가 고정된 회귀모형 

- 회귀분석 할 때는 형태 고정된 어떤 회귀함수로 모회귀모형을 설정하고, 그 모회귀모형의 추정모형(적합모형) 을 찾는다.  

## 모수회귀모형 종류 

- 단순선형회귀모형: $f(X) = \beta_{0}+\beta_{1}X$. 회귀함수가 1차원 선형함수다.
- 다중선형회귀모형: $f(X) = \beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}...+\beta_{n}X_{n}$. 회귀함수가 회귀계수와 설명변수 벡터의 선형조합 형태다. 
- 비선형회귀모형: $f(X) = \frac{\beta_{0}X}{\beta_{1}+X}$. 회귀함수는 $\beta$ 와 설명변수 $X$의 비선형결합 형태다.
- $k-$차 다항회귀모형: $f(X) = \beta_{0}+\beta_{1}X + \beta_{2}X^{2}+\beta_{3}X^{3}...+\beta_{k}X^{k}$. 회귀함수가 회귀계수와 설명변수 $X$ $k$차 항의 선형조합 형태다. 
- 로지스틱 회귀모형: 반응변수 $Y$ 가 이항분포(n번 중 성공 횟수)를 따를 때 
- 로그선형모형: 반응변수 $Y$가 포아송분포를 따를 때 

## 비모수회귀모형 

정의: 회귀함수 $f(X)$ 형태가 고정되어 있지 않은 회귀모형 

- 회귀함수는 특정 가정만 만족하면 된다. 예) 3번 미분 가능한 함수 

---

# 회귀분석의 논리 흐름

아래와 같이 실현된 데이터를 내가 갖고 있다고 가정해보자. 

<img width="292" alt="Screen Shot 2022-01-09 at 21 02 02" src="https://user-images.githubusercontent.com/83487073/148681382-179df175-f2b1-4abe-917c-903c2239968e.png">

이 데이터는 본래 어떤 형태 모형에서 실현되었을까? 알 수 없다. 데이터를 실현시킨 본래 '참모형(True model)' 을 아는 건 신의 영역이다. 인간은 알 수 없다. 

$\Rightarrow$ 데이터를 발생시킨 본래 모형을 '참모형(True model)' 이라고 한다. 

<img width="296" alt="Screen Shot 2022-01-09 at 21 09 25" src="https://user-images.githubusercontent.com/83487073/148681576-7a8da053-22f3-4b30-abdf-e114081d868c.png">

따라서 참 모형을 알아내는 건 우리 관심사가 아니다. 무슨 노력을 해도 알 수 없다. 미지의 영역이고, 신의 영역이다. 

따라서 우리 인간은 참 모형의 대안으로, 실현된 데이터를 가장 잘 설명해 줄 수 있을 것 같은 임의의 모형을 '설정' 한다. 이 모형을 '설정모형' 이라고 한다. 

위 산점도를 보니 데이터가 양의 선형 상관관계 있어 보인다. 데이터가 선형으로, 오른쪽 위를 향하고 있으므로 오른쪽 위를 향하는 '직선'으로 이 데이터를 잘 설명할 수 있을 걸로 보인다. 

직선 형태 회귀함수 갖는 회귀모형은 단순선형회귀모형이 있다. 단순선형회귀모형을 설정모형으로 선택한다. 

$\Rightarrow$ 설정모형: $Y = \beta_{0}+\beta_{1}X + \epsilon$

<img width="291" alt="Screen Shot 2022-01-09 at 21 19 00" src="https://user-images.githubusercontent.com/83487073/148681860-7104ebdc-ac82-4c04-8f45-a44de9e3a2ab.png">

이 설정모형의 회귀함수 $Y =\beta_{0}+\beta_{1}X$는 $Y \vert{X}$ 분포의 기댓값들을 연결한 것과 같다. 이 회귀함수를 모회귀함수(모회귀선) 라고 한다. 

<img width="664" alt="Screen Shot 2022-01-09 at 21 24 59" src="https://user-images.githubusercontent.com/83487073/148682084-6aa80cf2-7dd2-48f2-a09a-b37526a67ac2.png">

[이미지 출처: http://www.aistudy.com/math/regression_lee.htm ]

하지만 $Y \vert{X}$ 분포 기댓값들은 인간이 알 수 없는 미지의 값이다. 즉, 모회귀선은 알 수 없는 어떤 모수라고 생각할 수 있다. 미지의 모수를 추정하려면 실현된 데이터를 이용해서 추정치를 찾는다. 여기서도 마찬가지로, 실현된 데이터를 이용해서 모회귀선의 추정치를 찾는다. 

회귀선과 실현된 데이터 사이 차이를 '잔차'라고 하는데, 이 잔차 제곱합(총 잔차 크기)이 최소가 되는 회귀선을 모회귀선 추정치로 삼는다. 

$\Rightarrow$ 이 추정치를 '표본회귀선' 이라 부른다. 표본회귀선은 $Y \vert{X}$ 분포 기댓값 추정치를 연결한 선이다. 한편 정규분포 기댓값 모수는 하나인데 기댓값 모수 추정치(표본평균)은 표본 얻을 때 마다 달라지는 것 처럼, 표본회귀선도 표본 얻을 때 마다 달라진다. 곧, 1개 표본회귀선은 모회귀선에 대한 여러 추정치중 하나에 불과하다. 

<img width="590" alt="Screen Shot 2022-01-09 at 21 38 04" src="https://user-images.githubusercontent.com/83487073/148682475-3f895795-f5d3-48f9-a71b-3b29a1d9fce2.png">

[이미지 출처: http://www.aistudy.com/math/regression_lee.htm ]

표본회귀선을 회귀함수로 삼은 회귀모형을 표본회귀함수 또는 적합모형(fitted model) 이라고 한다. 

적합모형 = 표본회귀선(회귀함수) + $\epsilon$

<img width="300" alt="Screen Shot 2022-01-09 at 23 17 45" src="https://user-images.githubusercontent.com/83487073/148686185-ea613c59-8da5-4333-b240-54cc9be0b80f.png">

적합모형은 모회귀모형 또는 설정모형에 대한 추정모형이다. 

회귀분석의 최종목표는 주어진 데이터에 대해 적합모형의 회귀함수. 표본회귀선을 찾는 것이다. 

---

# 모수회귀모형 - 단순선형회귀모형

정의: 회귀함수가 $f(X) = \beta_{0}+\beta_{1}X$ 선형 형태로 고정된 회귀모형 

특징: 

- 설명변수 $X$ 가 1개다. 











