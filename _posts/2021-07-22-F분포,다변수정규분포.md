---

---

# F분포 : 카이제곱분포 표본/각각의 자유도 의 비율들이 이루는 분포 

- 모수 : 자유도 쌍 (N1, N2)
- 자유도 : (N1, N2)
- 카이제곱분포 표본 = 같은 정규분포에서 얻은 표본들의 제곱합
- t통계량 제곱의 분포도 자유도가 (1,N)인 F분포 따른다. 
---

```python
# t 통계량 제곱의 분포는 F(1, N)를 따른다. 
# N = 2

t = sp.stats.t(2)
t = t.rvs(100, random_state=0)**2
plt.subplot(1,2,1)
sns.distplot(t, kde=False)
plt.xlim(0, 100)
plt.title('t통계량 제곱의 분포')

f = sp.stats.f(1,2)
xx = np.linspace(0,100,100)
plt.subplot(1,2,2)
plt.plot(xx, f.pdf(xx))
plt.title('f분포 : 자유도 = (1,2)')

plt.tight_layout()
plt.show()
```
<img width="1080" alt="Screen Shot 2021-07-22 at 11 53 18" src="https://user-images.githubusercontent.com/83487073/126583832-fc5322f9-f0a9-4f5b-8c9c-12500fb375f0.png">

```python
# 2. N=30
t = sp.stats.t(N[1])
t = t.rvs(100)**2
plt.subplot(1,2,1)
sns.distplot(t, kde=False)
plt.xlim(0, 10)
plt.title('t통계량 제곱의 분포')

f = sp.stats.f(1,N[1])
xx = np.linspace(0,10)
plt.subplot(1,2,2)
plt.plot(xx, f.pdf(xx))
plt.ylim(0, 0.8)
plt.title('f 분포 : 자유도 = (1,30)')
plt.tight_layout()

plt.show()
```

<img width="1078" alt="Screen Shot 2021-07-22 at 11 53 57" src="https://user-images.githubusercontent.com/83487073/126583876-f8f0f27c-6854-4170-b2e9-11029b8c833a.png">

---

혹은

---

```python
# 다시해보기 
def plot(N) : 
    np.random.seed(0)
    t = sp.stats.t(N).rvs(1000)**2
    f = sp.stats.f(1, N).rvs(1000)

    plt.hist(t, label=f't통계량 제곱 분포 | 자유도 = {N}', bins=50, range=(0, 10), rwidth=0.5, align='left', color='r')
    plt.hist(f, label=f'f분포 표본 | 자유도 = (1, {N})', bins=50, range=(0,10), rwidth=0.5, align='mid', color='b')
    plt.xlim(0, 5)
    plt.legend()
    plt.title(f'N = {N} 인 경우')
    plt.show()


plt.subplot(211)
plot(2)
plt.subplot(212)
plot(30)
```
<img width="1072" alt="Screen Shot 2021-07-22 at 12 10 15" src="https://user-images.githubusercontent.com/83487073/126584915-be9db744-b05c-457b-8df1-25fd3c781801.png">

---

# F분포 특징
- 직관적으로 생각했을 때, N1 = N2일 경우 1근처 어떤 값이 가장 자주 나올 거라 생각된다. 

그 이유는 다음과 같다. 

카이제곱분포 표본은 같은 정규분포에서 나온다. 

표본 갯수인 N1, N2가 같다면, 아무래도 정규분포 상에서 확률밀도 높은쪽에서 N개 표본이 자주 발생할 것이다. 

예) 기댓값, 최빈값 근처

이 경우 카이제곱분포 표본값(정규분포 표본 제곱합)도 2개가 서로 비슷비슷한 값일 거다. 

N1, N2가 서로 같기 때문에 약분하면 결국 분자 분모에 서로 비슷비슷한 값이 남는다. 

이 비율값은 대략 1 근처 값이라 생각할 수 있다. 

이 경우 '자주 발생하는 F분포 표본값'은 '1근처 값 이다' 라고 직관적으로 생각할 수 있다. 

하지만 실제로는 1이 아닌 다른 어떤 값이 더 자주 나온다. 

- 이 현상은 N1=N2 값이 커질수록 사라진다. 

- 결국 1 근처 값이 가장 자주 발생하게 된다. 

##### F분포 특징 : N1=N2가 커질 수록 1근처 값이 가장 자주 발생한다. 

```python
N = [10,100,1000,10000]
M = 10000
np.random.seed(0)
rv = sp.stats.norm()

for i,n in enumerate(N) :
    plt.subplot(1,4,i+1)
    x1 = (rv.rvs(size=(n, M))**2).sum(axis=0)
    x2 = (rv.rvs(size=(n, M))**2).sum(axis=0)
    t = x1/x2
    sns.histplot(t, bins=200)
    plt.axvline(1, ls=':')
    plt.xlabel('$x$')
    plt.title(f'자유도 : {n}')
plt.suptitle('F분포 자유도 (N1,N2)가 커질 수록 1근처 값이 가장 자주 나온다')
plt.tight_layout()
plt.show()
```
<img width="1075" alt="Screen Shot 2021-07-22 at 11 08 44" src="https://user-images.githubusercontent.com/83487073/126581367-341491b0-d652-402f-97bf-4d96b0664804.png">

---

# 다변수 정규분포 
- 다변수 정규분포 차원은 확률변수벡터 차원 따라간다
- 


